<!DOCTYPE html>
<html lang="en-us">


<!-- google fonts -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, inital-scale=1.0">
    <title>Password Generator</title> <!-- appears in tab -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <!-- bootstrap elements -->
    <link rel="stylesheet" type="text/css" href="style.css"> <!-- link my stylesheet -->
</head>


<style>




</style>


<body>
    <div class="container">

        <!-- row with "Generate a PW" (& bottom dotted border) -->
        <div class="row">
            <div class="col-12">
                <h1 id="header">Generate a Password</h1>
            </div>
        </div>

        <!-- row with "Your secure pw" (surrounded by dotted border) -->
        <div class="row">
            <div class="col-12">
                <p id="securepw">Your Secure Password</p>
            </div>
        </div>

        <!-- buttons "Generate pw" and "Copy to clipboard" on same row -->
        <div class="row" id="buttons-top-border">

            <!-- Generate button -->
            <div class="col-6 text-left">
                <div id="generate">
                    <button type="button" class="btn btn-default btn-lg btn-dark rounded" onclick="getPW()">
                        <span class="">Generate Password</span>
                    </button>
                </div>
            </div> <!-- end of "Generate" button div -->

            <!-- Copy button -->
            <div class="col-6 text-right">
                <div id="clipboard">
                    <button type="button" class="btn btn-default btn-lg btn-secondary rounded">
                        <span class="">Copy to Clipboard</span>
                    </button>
                </div>
            </div> <!-- end of "Copy" button div -->

        </div> <!-- end of row with buttons -->

</body>


<script type="text/Javascript">

    function getLength() {
        var length = 0;  /* defines length and ensures while loop runs at least once */
        while (length < 8 || length > 128) {    /* will continue to ask if length is not a valid number */
        
            length = prompt("How many characters would you like in your password?\nPlease enter a number between 8 and 128.");

        /* re-prompt if user entered something that is not a number */
            if (isNaN(length)) {    
                alert('You must enter a number.\nYou entered "' + length + '".');
                length = 0;  /* to continue while loop */
            }

        /* re-prompt if user entered a number less than 8 */
            else if (length < 8) {
                alert("You must enter a number greater than 8.\nYou entered " + length + ".");
            }

        /* re-prompt if user entered a number greater than 128 */
            else if (length > 128) {
                alert("You must enter a number less than 128.\nYou entered " + length + ".");
            }
        }  /* end of while loop */

    /* we have a valid entry for the length of the password! */
    return length = parseInt(length);  /* make length a number datatype  and returns it */
    }  /* end of function getLength */


function getRequirements() {
    var choice = null;
    alert("requiredBooleans (getRequirements): " + requiredBooleans);

     
    for (var i = 0; i < 4; i++) {
        requiredBooleans[i] = confirm("Would you like at least one " + requireQuestions[i] + "?");
    }
    
    while (!(requiredBooleans[0] || requiredBooleans[1] || requiredBooleans[2] || requiredBooleans[3])) {
        choice = prompt("You must choose at least one of the following:\n1: A special character\n2: A number\n3: An uppercase letter, or\n4: a lowercase letter.\nPlease enter the corresponding number.");
 /* check input - must be 1, 2, 3 or 4.  If not, re-prompt */
 /* re-prompt if choice entered is not a number */
        if (isNaN(choice)) {
            alert("You entered " + choice + ", which is not a number.\nPlease enter a number between 1 and 4 on the next prompt.");
        }
 /* re-prompt if choice entered is less than 1 */        
        else if (choice < 1) {
            alert("You entered " + choice + ", which is less than 1.\nPlease enter a number between 1 and 4 on the next promp.");
        }

 /* re-prompt if choice entered is greater than 4 */        
        else if (choice > 4) {
            alert("You entered " + choice + ", which is greater than 4.\nPlease enter a number between 1 and 4 on the next prompt.");
        }

 /* choice is valid; change corresponding character type to true (required) */   
        else {
            requiredBooleans[choice] = true;
        }
    } /* of while loop */

}  /* end of function getRequirements  */


/* randomly generate the number of each type of character, including at least one of each type requested. */
function getNumberOfEachType() {
    var lengthLeft = pwLength;   /*  lengthLeft keeps track of how many characters are left to distribute among remaining types */
    /* numTypes used to leave at least one character for all required types */
    var numTypes = 0;
    for (var i = 0; i < 4; i++) {
        numTypes = numTypes + requiredBooleans[i];
    }
    

    /* Generate the number of each character type */
    for (var i = 0; i < 4; i++) {  


        if (requiredBooleans[i]) {
            numTypes--;   /* used to leave at least one character for each of the remaining required types of characters */
            if (numTypes == 0) {  /* if this is the last type left, all the remaining types need to be the current type */
                numEachCharType[i] = lengthLeft;
                lengthLeft = 0;
            }  /* of if */
            else {      /* generate a number between 1 and the max number of Spec Characters needed */
                numEachCharType[i] = Math.floor(Math.random() * (lengthLeft - numTypes)) + 1;
                lengthLeft = lengthLeft - numEachCharType[i];  /* lengthLeft is the number of characters of other types remaining */
            }  /* of else */
        }  /* of if requireSpecCharacter */
    
    } /* of for loop */
    
}  /* of getNumberOfEachType function */



function generateIndices() {
    var indicies = [];   /* simple array of indicies into PW for current char type. */


    return indicies;
}


/* needs to be revised!!!  */
function assignPW() {
    var char;
    var type;
    var index;
    var pw = " ";
   

console.log(" ");    
console.log(" ");    
console.log(" ");    
console.log("begin assigning PW.  Char & Type: " + char + type);
    for (var i = 0; i < pwLength; i++) {
console.log(" ");    
        console.log("i: " + i);
        type = Math.floor(Math.random() * 4);

        if (type == 0 && numSpecCharacters > 0) {
            index = Math.floor(Math.random() * specCharacters.length);
            char = specCharacters[index];
            numSpecCharacters--;
            pw = pw + char;
        }

        else if (type == 1 && numNumbers > 0) {
            index = Math.floor(Math.random() * numbers.length);
            char = numbers[index];
            numNumbers--;
            pw = pw + char;
        }

        else if (type == 2 && numUpperCase > 0) {
            index = Math.floor(Math.random() * upperCase.length);
            char = upperCase[index];
            numUpperCase--;
            pw = pw + char;
        }

        else if (type == 3 && numLowerCase > 0) {
            index = Math.floor(Math.random() * lowerCase.length);
            char = lowerCase[index];
            numLowerCase--;
            pw = pw + char;
        }
        else {
            i--;
        }



    }
    return pw;
    
}



/* only do anything if a button is clicked. */
/* declare & initialize global variables */

/* possible characters to choose from, by character type. Order: Special, number, Uppercase, lowercase */
    var possibleCharacters = [
        ["!", "#", "$", "%", "&", "(", ")", "*", "+", "-", "/", ":", ";", "<", "=", ">", "?", "@", "^", "_", "`", "{", "|", "}", "~"], /* spec chars */
        [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], /* numbers */
        ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"], /* uppercase */
        ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"] /* lowercase */
       ] 

/* variables needed to ask the user what requirements they want */
/* length of password  */
    var pwLength = 0;  
/* assume none of the character types are required to begin with. */
    var requiredBooleans = [false, false, false, false]; /* SpecChar, #s, UpperCase, LowerCase */
    alert("requiredBooleans (init): " + requiredBooleans);
/* verbiage for each character type, in order */
    var requireQuestions = ["special character", "number", "uppercase letter", "lowercase letter"];
    
/* number of each character type to include in password.  Will be 0 if not wanted.  Sum of elements should = pwLength */
    var numEachCharType = [0, 0, 0, 0];
/* indicies into password for each of the character types.  Total number of indicies should = pwLength */
    var indiciesForEachCharType = [ [], [], [], []];

/* initialize password to be generated */
    var password = null;
/* pwCharLeft keeps track of how many characters are left to work with */
    var pwCharLeft = pwLength;

function getPW() {
    pwLength = getLength();     /* ask & verify length of password desired */
    getRequirements();          /* ask user which requirements they want, validate input, reprompt if needed */
    getNumberOfEachType();      /* randomly determine how many of each REQUESTED char type will be generated (0 if not requested as a placeholder) */

/* for testing - how many of each char type will be generated */
    for (var i = 0; i < 4; i++) {
        console.log(requireQuestions[i] + ": " + numEachCharType[i]);
    }
    alert("Length: " + pwLength + "\nSpec Char: " + numEachCharType[0] + "\nnumbers: " + numEachCharType[1] + "\nUC: " + numEachCharType[2] + "\nlc: " + numEachCharType[3]);

/* generate the indicies into password for each char type.  */
    for (var i = 0; i < 4; i++) {
        indiciesForEachCharType[i] =  generateIndices();
    }

    /* password = assignPW(); */
    alert("Complete Password: " + password);


    /* put pw on website */
    securepw.textContent = password;
    /* change formatting */
    securepw.style.color = "blue";
    securepw.style.weight = "700";
}

</script>


</html>